<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.petservice.mapper.ListPetsMapper">
    <select id="selectByPage" resultType="com.example.petpojo.entity.Pets">
        SELECT 
            p.pid,
            p.name,
            p.breed,
            p.age,
            p.gender,
            p.img_url,
            p.species,
            p.status,
            p.shelter_id,
            s.sid,
            s.name as shelterName,
            s.location as shelterAddress
        FROM pets p
        LEFT JOIN shelters s ON p.shelter_id = s.sid
        WHERE p.status = 'UNADOPTED'
        ORDER BY p.pid
    </select>
    
    <select id="selectPetById" resultType="com.example.petpojo.entity.Pets">
        SELECT 
            p.pid,
            p.name,
            p.breed,
            p.age,
            p.gender,
            p.img_url,
            p.species,
            p.status,
            p.shelter_id,
            s.sid,
            s.name as shelterName,
            s.location as shelterAddress
        FROM pets p
        LEFT JOIN shelters s ON p.shelter_id = s.sid
        WHERE p.pid = #{petId}
    </select>
    
    <!-- 新增直接返回PetListVo的查询语句 -->
    <select id="selectPetListByPage" resultType="com.example.petpojo.vo.PetListVo">
        SELECT 
            p.pid,
            p.name,
            p.species,
            p.breed,
            p.age,
            p.gender,
            p.img_url as imgUrl,
            p.status,
            s.name as shelterName,
            s.location as shelterAddress
        FROM pets p
        LEFT JOIN shelters s ON p.shelter_id = s.sid
        WHERE p.status = 'UNADOPTED'
        ORDER BY p.pid
    </select>
    
    <select id="selectPetListById" resultType="com.example.petpojo.vo.PetListVo">
        SELECT 
            p.pid,
            p.name,
            p.species,
            p.breed,
            p.age,
            p.gender,
            p.img_url as imgUrl,
            p.status,
            s.name as shelterName,
            s.location as shelterAddress
        FROM pets p
        LEFT JOIN shelters s ON p.shelter_id = s.sid
        WHERE p.pid = #{petId}
    </select>
</mapper>