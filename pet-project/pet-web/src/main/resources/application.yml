# 公共配置（开发/生产都能用）
spring:
  application:
    name: pet-web
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:dev}  # 核心：用环境变量激活环境，默认开发环境
  main:
    allow-circular-references: true
  web:
    resources:
      static-locations:
        - classpath:/static/
        - file:${app.upload-dir}/images/
  # DevTools 热部署配置
  devtools:
    restart:
      enabled: true
      # 排除不需要触发重启的资源
      exclude: static/**,public/**,*.log
      additional-exclude: target/classes/com/example/demo/entity/**,target/classes/com/example/demo/mapper/**
  # 文件上传配置
  servlet:
    multipart:
      max-file-size: 500MB
      max-request-size: 500MB

# 服务器配置
server:
  port: 8080
  address: 0.0.0.0
  servlet:
    context-path: /api

# Redis配置
pet:
  # redis:
  #   host: ${REDIS_HOST:localhost}
  #   port: ${REDIS_PORT:6379}
  #   password: ${REDIS_PASSWORD:zx4221335}
  #   database: ${REDIS_DATABASE:0}
  jwt:
    user-secret-key: ${JWT_USER_SECRET_KEY:itheimaSecretKeyThatIsLongEnoughForHS256AlgorithmRequirements}
    refresh-secret-key: ${JWT_REFRESH_SECRET_KEY:itheimaRefreshSecretKeyThatIsLongEnoughForHS256AlgorithmRequirements}
    user-ttl: ${JWT_USER_TTL:7200000}
    refresh-ttl: ${JWT_REFRESH_TTL:604800000}
#    user-ttl: ${JWT_USER_TTL:60000}
#    refresh-ttl: ${JWT_REFRESH_TTL:120000}

# MyBatis Plus 配置
mybatis-plus:
  configuration:
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
    #开启驼峰命名
    map-underscore-to-camel-case: true
  global-config:
    db-config:
      id-type: auto
      logic-delete-field: deleted
      logic-delete-value: 1
      logic-not-delete-value: 0

# 日志配置
logging:
  level:
    com.example: debug
    org.springframework: debug
    org.springframework.web: debug
    org.springframework.boot.autoconfigure: debug
    com.baomidou.mybatisplus: debug
    com.example.petcommon: debug
    root: info

# 应用配置
app:
  upload-dir: ${UPLOAD_DIR:${java.io.tmpdir}demo-project-uploads/media}
  upload-max-size: ${UPLOAD_MAX_SIZE:524288500}  # 500MB

# SpringDoc OpenAPI 配置
springdoc:
  api-docs:
    path: /v3/api-docs
    enabled: true
  swagger-ui:
    path: /swagger-ui.html
    enabled: true
    disable-swagger-default-url: true
  # 确保导出的OpenAPI规范包含服务器信息
  writer-with-default-pretty-printer: true

# Knife4j配置
knife4j:
  enable: true
  setting:
    language: zh_cn
    enable-swagger-models: true
    enable-document-manage: true
    swagger-model-name: Swagger Models
    enable-version: false
    enable-reload-cache-parameter: false
    enable-after-script: true
    enable-filter-multipart-api-method-type: POST
    enable-filter-multipart-apis: false
    enable-request-cache: true
    enable-host: false
    enable-host-text: ''
    enable-terms-of-service: false
    enable-include-pattern: ''
    enable-plus: false
    enable-footer: false
    enable-footer-custom: false
    footer-custom-content: ''
    enable-search: false
    enable-open-api: false
    enable-group: false

# 阿里云OSS配置 
aliyun:
  oss:
    # OSS接入点，根据实际地域修改
    endpoint: ${ALIYUN_OSS_ENDPOINT:oss-cn-hangzhou.aliyuncs.com}
    # Bucket名称
    bucket-name: ${ALIYUN_OSS_BUCKET_NAME:cjs-pet-project}
    # 地域ID
    region: ${ALIYUN_OSS_REGION:cn-hangzhou}
    # 访问路径前缀
    url-prefix: ${ALIYUN_OSS_URL_PREFIX:https://cjs-pet-project.oss-cn-hangzhou.aliyuncs.com/}
    # 访问密钥ID和密钥
    access-key-id: ${ALIYUN_OSS_ACCESS_KEY_ID:LTAI5tDw2XP2rTZdtFtmAyZV}
    access-key-secret: ${ALIYUN_OSS_ACCESS_KEY_SECRET:woB6fu72wLJNAplv4B9AQHPRPzdoqF}

# 健康提醒清理配置
health:
  reminder:
    cleanup:
      # 不同健康类型的过期天数配置
      expiry-days:
        default: 1
        疫苗接种: 7
        驱虫: 5
        体检: 3
        洗澡: 2
      # 归档阈值（过期后多少天归档）
      archive-threshold-days: 30
      # 是否启用自动删除超长期归档记录
      enable-deletion: true
      # 删除阈值（归档后多少天删除）
      deletion-threshold-days: 365