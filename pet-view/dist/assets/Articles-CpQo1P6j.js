import{_ as z}from"./dog-CLIpk0wi.js";import{u as B,h as g,l as V,E as k,d as T,k as $,c as m,o as d,a as n,N as M,z as I,O as R,e as l,w as c,r as F,P as G,m as t,F as O,f as Q,n as U,g as v,Q as q,t as p,p as H,G as J,R as K,S as W,_ as X}from"./index-BSW2uGQz.js";import{useThemeStore as Y}from"./theme-B7pFg6HI.js";import{s as j}from"./request-qgYNvrL7.js";import{P as Z}from"./Pagination-D8a42XQ7.js";const ee=()=>{const x=V(),{t:i}=B(),f=Y(),u=g(!1),A=g([]),_=g(1),y=g(12),w=g(0),C=g(0),h=async()=>{u.value=!0;try{const a=await j.get("/articles",{params:{currentPage:_.value,pageSize:y.value}});if(a.code===200){const o=a.data.records||[];A.value=o.map(e=>({id:e.id,title:e.title,content:e.content,summary:e.summary||"",coverImage:e.coverImage,author:e.author||i("admin"),viewCount:e.viewCount||0,createdAt:e.createdAt||"",updatedAt:e.updatedAt||""})),w.value=a.data.total||0,C.value=a.data.pages||0}else k.error(i("api.getArticleListFailed"))}catch(a){console.error(i("api.getArticleListFailed"),a),k.error(i("api.getArticleListFailed"))}finally{u.value=!1}};return{loading:u,articles:A,currentPage:_,pageSize:y,total:w,totalPages:C,themeStore:f,fetchArticles:h,fetchArticleDetail:async a=>{try{const s=await j.get(`/articles/${a}`),o=s.data;return s.code===200&&o?{id:o.id,title:o.title,content:o.content,summary:o.summary||"",coverImage:o.coverImage,author:o.author||i("admin"),viewCount:o.viewCount||0,createdAt:o.createdAt||"",updatedAt:o.updatedAt||""}:(k.error(i("api.getArticleListFailed")),null)}catch(s){return console.error(i("api.getArticleDetailFailed"),s),k.error(i("api.getArticleDetailFailed")),null}},viewArticle:a=>{x.push(`/user/articles-detail/${a}`)},handlePageChange:a=>{_.value=a,h()},formatDate:a=>new Date(a).toLocaleDateString("zh-CN"),getArticleSummary:a=>{const s=a.replace(/<[^>]*>/g,"");return s.length>100?s.substring(0,100)+"...":s},handleImageError:a=>{const s=a.target;s.src="/images/default-article.jpg"},initialize:()=>{h()}}},te={class:"carousel-container"},ae={class:"articles-grid"},se=["onClick"],re={class:"article-cover"},oe=["alt"],ne={class:"view-count"},le={class:"article-content"},ie={class:"article-title"},ce={class:"article-summary"},de={class:"article-meta"},ue={class:"article-author"},ge={class:"article-date"},me={key:0,class:"article-updated"},pe={key:0,class:"empty-state"},_e=T({__name:"Articles",setup(x){const{loading:i,articles:f,currentPage:u,pageSize:A,total:_,totalPages:y,themeStore:w,viewArticle:C,handlePageChange:h,formatDate:D,getArticleSummary:E,handleImageError:S,initialize:L}=ee();return $(()=>{L()}),(b,r)=>{const P=F("el-carousel-item"),a=F("el-carousel"),s=F("el-icon"),o=G("loading");return d(),m("div",{class:U(["articles-container",{dark:t(w).preferences.theme==="dark"}])},[n("div",te,[l(a,{height:"400px","indicator-position":"outside",arrow:"always"},{default:c(()=>[l(P,null,{default:c(()=>[...r[2]||(r[2]=[n("img",{src:z,alt:"可爱的宠物",style:{width:"100%",height:"100%","object-fit":"cover"}},null,-1)])]),_:1}),l(P,null,{default:c(()=>[...r[3]||(r[3]=[n("img",{src:z,alt:"可爱的宠物",style:{width:"100%",height:"100%","object-fit":"cover"}},null,-1)])]),_:1}),l(P,null,{default:c(()=>[...r[4]||(r[4]=[n("img",{src:z,alt:"可爱的宠物",style:{width:"100%",height:"100%","object-fit":"cover"}},null,-1)])]),_:1})]),_:1})]),M((d(),m("div",ae,[(d(!0),m(O,null,Q(t(f),e=>(d(),m("div",{key:e.id,class:"article-card",onClick:N=>t(C)(e.id)},[r[5]||(r[5]=v(" > ",-1)),n("div",re,[n("img",{src:"/src/assets/img/dog.jpg",alt:e.title,onError:r[0]||(r[0]=(...N)=>t(S)&&t(S)(...N))},null,40,oe),n("div",ne,[l(s,null,{default:c(()=>[l(t(q))]),_:1}),v(" "+p(e.viewCount),1)])]),n("div",le,[n("h3",ie,p(e.title),1),n("p",ce,p(e.summary||t(E)(e.content)),1),n("div",de,[n("span",ue,[l(s,null,{default:c(()=>[l(t(H))]),_:1}),v(" "+p(e.author||"管理员"),1)]),n("span",ge,[l(s,null,{default:c(()=>[l(t(J))]),_:1}),v(" "+p(t(D)(e.createdAt)),1)]),e.updatedAt&&e.updatedAt!==e.createdAt?(d(),m("span",me,[l(s,null,{default:c(()=>[l(t(K))]),_:1}),v(" "+p(t(D)(e.updatedAt)),1)])):I("",!0)])])],8,se))),128))])),[[o,t(i)]]),!t(i)&&t(f).length===0?(d(),m("div",pe,[l(s,null,{default:c(()=>[l(t(W))]),_:1}),r[6]||(r[6]=n("p",null,"暂无文章",-1))])):I("",!0),t(y)>1?(d(),R(Z,{key:1,"current-page":t(u),"page-size":t(A),total:t(_),"onUpdate:currentPage":r[1]||(r[1]=e=>u.value=e),onPageChange:t(h)},null,8,["current-page","page-size","total","onPageChange"])):I("",!0)],2)}}}),we=X(_e,[["__scopeId","data-v-624753c2"]]);export{we as default};
