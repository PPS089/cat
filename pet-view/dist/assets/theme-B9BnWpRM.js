import{ag as g,h,ah as v}from"./index-CdkwbEeW.js";const m=(e,t)=>{if(e.startsWith("#")){const s=parseInt(e.replace("#",""),16),r=Math.max(0,Math.min(255,(s>>16)+t)),o=Math.max(0,Math.min(255,(s>>8&255)+t)),l=Math.max(0,Math.min(255,(s&255)+t));return`#${(r<<16|o<<8|l).toString(16).padStart(6,"0")}`}return e},f=e=>{const t=()=>{setTimeout(()=>{const r=document.querySelector(".top-header");r&&(r.style.background=`linear-gradient(135deg, ${e.value.primaryColor} 0%, ${m(e.value.primaryColor,-20)} 100%)`);const o=document.querySelector(".sidebar");o&&(e.value.theme==="dark"?o.style.background="linear-gradient(180deg, #1f1f1f 0%, #141414 100%)":o.style.background="linear-gradient(180deg, #ffffff 0%, #f8f9fa 100%)"),document.querySelectorAll(".nav-link.active").forEach(n=>{n.style.background=`linear-gradient(135deg, ${e.value.primaryColor} 0%, ${m(e.value.primaryColor,-20)} 100%)`});const i=document.querySelector(".user-dropdown-header");i&&(i.style.background=`linear-gradient(135deg, ${e.value.primaryColor} 0%, ${m(e.value.primaryColor,-20)} 100%)`),document.querySelectorAll(".el-button--primary").forEach(n=>{n.style.backgroundColor=e.value.primaryColor,n.style.borderColor=e.value.primaryColor}),document.documentElement.style.setProperty("--el-color-primary",e.value.primaryColor),document.documentElement.style.setProperty("--el-color-primary-light-3",m(e.value.primaryColor,30)),document.documentElement.style.setProperty("--el-color-primary-light-5",m(e.value.primaryColor,50)),document.documentElement.style.setProperty("--el-color-primary-light-7",m(e.value.primaryColor,70)),document.documentElement.style.setProperty("--el-color-primary-light-8",m(e.value.primaryColor,80)),document.documentElement.style.setProperty("--el-color-primary-light-9",m(e.value.primaryColor,90)),document.documentElement.style.setProperty("--el-color-primary-dark-2",m(e.value.primaryColor,-20))},100)};return{applyThemeDOM:()=>{document.documentElement.style.setProperty("--el-color-primary",e.value.primaryColor);const r=e.value.theme,o=document.documentElement.classList.contains("dark"),l=document.documentElement.classList.contains("light");r==="dark"?(o||document.documentElement.classList.add("dark"),l&&document.documentElement.classList.remove("light")):r==="light"?(l||document.documentElement.classList.add("light"),o&&document.documentElement.classList.remove("dark")):window.matchMedia("(prefers-color-scheme: dark)").matches?(o||document.documentElement.classList.add("dark"),l&&document.documentElement.classList.remove("light")):(l||document.documentElement.classList.add("light"),o&&document.documentElement.classList.remove("dark"));const i=document.documentElement.style.fontSize,d=e.value.fontSize+"px";i!==d&&(document.documentElement.style.setProperty("--base-font-size",d),document.documentElement.style.fontSize=d);const n=e.value.animations,a=document.documentElement.classList.contains("no-animations");!n&&!a?(document.documentElement.style.setProperty("--el-transition-duration","0s"),document.documentElement.classList.add("no-animations")):n&&a&&(document.documentElement.style.removeProperty("--el-transition-duration"),document.documentElement.classList.remove("no-animations"));const c=e.value.compactMode,u=document.documentElement.classList.contains("compact-mode");c&&!u?document.documentElement.classList.add("compact-mode"):!c&&u&&document.documentElement.classList.remove("compact-mode"),setTimeout(()=>{t()},0)},updateHeaderAndSidebarTheme:t}},C=g("theme",()=>{const e={language:"zh-CN",theme:"light",primaryColor:"#409EFF",fontSize:14,animations:!0,compactMode:!1},t=h({...e}),s=()=>{try{localStorage.setItem("language",t.value.language),localStorage.setItem("theme",t.value.theme),localStorage.setItem("primaryColor",t.value.primaryColor),localStorage.setItem("preferences",JSON.stringify({fontSize:t.value.fontSize,animations:t.value.animations,compactMode:t.value.compactMode}))}catch{}},{applyThemeDOM:r}=f(t),o=()=>{r()},l=()=>{try{const a=localStorage.getItem("language");a&&(t.value.language=a);const c=localStorage.getItem("theme");c&&["light","dark","auto"].includes(c)&&(t.value.theme=c);const u=localStorage.getItem("primaryColor");u&&(t.value.primaryColor=u);const y=localStorage.getItem("preferences");if(y)try{const p=JSON.parse(y);Object.assign(t.value,p)}catch{}}catch{}},i=(a,c)=>{t.value[a]=c,s(),o()},d=a=>{Object.assign(t.value,a),s(),o()},n=()=>{t.value={...e},s(),o()};return{preferences:v(t),loadPreferences:l,updatePreference:i,updatePreferences:d,applyTheme:o,resetToDefault:n}});export{C as useThemeStore};
