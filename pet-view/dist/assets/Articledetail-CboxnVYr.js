import{u as L,h as g,E as f,i as B,d as F,v as z,N as M,P as V,l as e,o as n,c as d,z as y,a,t as u,e as i,w as c,r as k,F as H,f as R,B as $,T as j,n as G,m as O,G as P,R as Q,Q as q,O as J,g as D,S as K}from"./index-CdkwbEeW.js";import{useThemeStore as U}from"./theme-B9BnWpRM.js";import{s as W}from"./request-AZOEAvTT.js";const X=()=>{const{t:o}=L(),h=B(),t=U(),m=g(!1),_=g(null),p=g(!1),A=g([o("article.petCare"),o("article.knowledgeSharing"),o("article.experienceSummary")]);return{loading:m,article:_,isLiked:p,articleTags:A,themeStore:t,t:o,fetchArticleDetail:async()=>{const s=Number(h.params.id);if(!s){f.error(o("api.invalidArticleId"));return}m.value=!0;try{const l=await W.get(`/articles/${s}`);if(l.code===200&&l.data){const r=l.data;_.value={id:r.id||0,title:r.title||"",content:r.content||"",summary:r.summary||"",createdAt:r.createdAt||"",viewCount:r.viewCount||0,coverImage:r.coverImage||"",author:r.author||"",updatedAt:r.updatedAt||""}}else f.error(o("api.getArticleDetailFailed"))}catch(l){console.error(o("api.getArticleDetailFailed"),l),f.error(o("api.getArticleDetailFailed"))}finally{m.value=!1}},formatDate:s=>new Date(s).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"}),formatContent:s=>s.split(`

`).map(r=>`<p>${r}</p>`).join(""),likeArticle:()=>{p.value=!p.value,f.success(p.value?o("api.likeSuccess"):o("api.unlikeSuccess"))},shareArticle:()=>{navigator.share?navigator.share({title:_.value?.title||"",text:_.value?.summary||"",url:window.location.href}):(navigator.clipboard.writeText(window.location.href),f.success(o("api.linkCopied")))},handleImageError:s=>{const l=s.target;l.style.display="none"}}},Y={key:0,class:"article-content"},Z={class:"article-header"},ee={class:"article-title"},te={class:"article-meta"},ae={class:"meta-item"},se={class:"meta-item"},le={key:0,class:"meta-item"},re={class:"meta-item"},ie={key:0,class:"article-cover"},oe=["src","alt"],ne={key:0,class:"article-summary"},ce={class:"article-body"},de=["innerHTML"],ue={class:"article-footer"},me={class:"article-tags"},_e={class:"article-actions"},pe={key:1,class:"empty-state"},ge=F({__name:"Articledetail",setup(o){const{loading:h,article:t,isLiked:m,articleTags:_,themeStore:p,fetchArticleDetail:A,formatDate:C,formatContent:I,likeArticle:S,shareArticle:x,handleImageError:w}=X();return z(()=>{A()}),(E,s)=>{const l=k("el-icon"),r=k("el-alert"),N=k("el-tag"),T=k("el-button"),b=V("loading");return M((n(),d("div",{class:G(["article-detail-container",{dark:e(p).preferences.theme==="dark"}])},[e(t)?(n(),d("div",Y,[a("header",Z,[a("h1",ee,u(e(t).title),1),a("div",te,[a("div",ae,[i(l,null,{default:c(()=>[i(e(O))]),_:1}),a("span",null,u(e(t).author||"管理员"),1)]),a("div",se,[i(l,null,{default:c(()=>[i(e(P))]),_:1}),a("span",null,u(e(C)(e(t).createdAt)),1)]),e(t).updatedAt&&e(t).updatedAt!==e(t).createdAt?(n(),d("div",le,[i(l,null,{default:c(()=>[i(e(Q))]),_:1}),a("span",null,"更新于 "+u(e(C)(e(t).updatedAt)),1)])):y("",!0),a("div",re,[i(l,null,{default:c(()=>[i(e(q))]),_:1}),a("span",null,u(e(t).viewCount)+" 次阅读",1)])]),e(t).coverImage?(n(),d("div",ie,[a("img",{src:e(t).coverImage,alt:e(t).title,onError:s[0]||(s[0]=(...v)=>e(w)&&e(w)(...v))},null,40,oe)])):y("",!0)]),e(t).summary?(n(),d("div",ne,[i(r,{title:e(t).summary,type:"info",closable:!1},null,8,["title"])])):y("",!0),a("main",ce,[a("div",{class:"article-text",innerHTML:e(I)(e(t).content)},null,8,de)]),a("footer",ue,[a("div",me,[(n(!0),d(H,null,R(e(_),v=>(n(),J(N,{key:v,size:"small",type:"info"},{default:c(()=>[D(u(v),1)]),_:2},1024))),128))]),a("div",_e,[i(T,{onClick:e(S),icon:e($),type:e(m)?"warning":"default"},{default:c(()=>[D(u(e(m)?"已收藏":"收藏"),1)]),_:1},8,["onClick","icon","type"]),i(T,{onClick:e(x),icon:e(j),type:"primary"},{default:c(()=>[...s[1]||(s[1]=[D(" 分享 ",-1)])]),_:1},8,["onClick","icon"])])])])):e(h)?y("",!0):(n(),d("div",pe,[i(l,null,{default:c(()=>[i(e(K))]),_:1}),s[2]||(s[2]=a("p",null,"文章不存在或已删除",-1))]))],2)),[[b,e(h)]])}}});export{ge as default};
