import{u as N,h as g,E as f,i as F,d as V,k as B,q as M,S as z,m as e,o as n,c as _,D as C,a as t,t as p,e as o,w as c,r as y,F as H,f as R,H as $,V as j,n as q,A as K,K as U,T as G,R as J,g as D,U as O}from"./index-CzjmnDZ-.js";import{useThemeStore as P}from"./theme-BvsCIQ48.js";import{s as Q}from"./request-Dybetxu6.js";const W=()=>{const{t:l}=N(),h=F(),r=P(),d=g(!1),u=g(null),m=g(!1),k=g([l("article.petCare"),l("article.knowledgeSharing"),l("article.experienceSummary")]);return{loading:d,article:u,isLiked:m,articleTags:k,themeStore:r,t:l,fetchArticleDetail:async()=>{const a=Number(h.params.id);if(!a){f.error(l("api.invalidArticleId"));return}d.value=!0;try{const s=await Q.get(`/articles/${a}`);if(s.code===200&&s.data){const i=s.data;u.value={id:i.id||0,title:i.title||"",content:i.content||"",summary:i.summary||"",createdAt:i.createdAt||"",viewCount:i.viewCount||0,coverImage:i.coverImage||"",author:i.author||""}}else f.error(l("api.getArticleDetailFailed"))}catch(s){console.error(l("api.getArticleDetailFailed"),s),f.error(l("api.getArticleDetailFailed"))}finally{d.value=!1}},formatDate:a=>new Date(a).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"}),formatContent:a=>a.split(`

`).map(i=>`<p>${i}</p>`).join(""),likeArticle:()=>{m.value=!m.value,f.success(m.value?l("api.likeSuccess"):l("api.unlikeSuccess"))},shareArticle:()=>{navigator.share?navigator.share({title:u.value?.title||"",text:u.value?.summary||"",url:window.location.href}):(navigator.clipboard.writeText(window.location.href),f.success(l("api.linkCopied")))},handleImageError:a=>{const s=a.target;s.style.display="none"}}},X={key:0,class:"article-content"},Y={class:"article-header"},Z={class:"article-title"},ee={class:"article-meta"},te={class:"meta-item"},ae={class:"meta-item"},se={class:"meta-item"},re={key:0,class:"article-cover"},le=["src","alt"],ie={key:0,class:"article-summary"},oe={class:"article-body"},ne=["innerHTML"],ce={class:"article-footer"},de={class:"article-tags"},ue={class:"article-actions"},me={key:1,class:"empty-state"},he=V({__name:"Articledetail",setup(l){const{loading:h,article:r,isLiked:d,articleTags:u,themeStore:m,fetchArticleDetail:k,formatDate:w,formatContent:I,likeArticle:S,shareArticle:x,handleImageError:A}=W();return B(()=>{k()}),(E,a)=>{const s=y("el-icon"),i=y("el-alert"),b=y("el-tag"),T=y("el-button"),L=z("loading");return M((n(),_("div",{class:q(["article-detail-container",{dark:e(m).preferences.theme==="dark"}])},[e(r)?(n(),_("div",X,[t("header",Y,[t("h1",Z,p(e(r).title),1),t("div",ee,[t("div",te,[o(s,null,{default:c(()=>[o(e(K))]),_:1}),t("span",null,p(e(r).author||"管理员"),1)]),t("div",ae,[o(s,null,{default:c(()=>[o(e(U))]),_:1}),t("span",null,p(e(w)(e(r).createdAt)),1)]),t("div",se,[o(s,null,{default:c(()=>[o(e(G))]),_:1}),t("span",null,p(e(r).viewCount)+" 次阅读",1)])]),e(r).coverImage?(n(),_("div",re,[t("img",{src:e(r).coverImage,alt:e(r).title,onError:a[0]||(a[0]=(...v)=>e(A)&&e(A)(...v))},null,40,le)])):C("",!0)]),e(r).summary?(n(),_("div",ie,[o(i,{title:e(r).summary,type:"info",closable:!1},null,8,["title"])])):C("",!0),t("main",oe,[t("div",{class:"article-text",innerHTML:e(I)(e(r).content)},null,8,ne)]),t("footer",ce,[t("div",de,[(n(!0),_(H,null,R(e(u),v=>(n(),J(b,{key:v,size:"small",type:"info"},{default:c(()=>[D(p(v),1)]),_:2},1024))),128))]),t("div",ue,[o(T,{onClick:e(S),icon:e($),type:e(d)?"warning":"default"},{default:c(()=>[D(p(e(d)?"已收藏":"收藏"),1)]),_:1},8,["onClick","icon","type"]),o(T,{onClick:e(x),icon:e(j),type:"primary"},{default:c(()=>[...a[1]||(a[1]=[D(" 分享 ",-1)])]),_:1},8,["onClick","icon"])])])])):e(h)?C("",!0):(n(),_("div",me,[o(s,null,{default:c(()=>[o(e(O))]),_:1}),a[2]||(a[2]=t("p",null,"文章不存在或已删除",-1))]))],2)),[[L,e(h)]])}}});export{he as default};
