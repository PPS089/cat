import{u as I,h as m,k as V,E as y,d as F,v as E,c as f,o as d,a as o,N as L,z as H,O as N,e as i,w as c,r as B,P as j,l as a,F as q,f as W,n as Y,g as b,Q as T,t as g,m as $,G as R,R as O,S as Q}from"./index-n6QoKQtw.js";import{useThemeStore as U}from"./theme-D8ZsPEis.js";import{s as G}from"./request-BS93o2BH.js";import{P as J}from"./Pagination-CmoWuIJY.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X=()=>{const P=V(),{t:l}=I(),_=U(),u=m(!1),v=m([]),p=m(1),A=m(12),w=m(0),x=m(0),h=async()=>{u.value=!0;try{const s=await G.get("/articles",{params:{currentPage:p.value,pageSize:A.value}});if(s.code===200){const t=s.data,r=t.records||[];v.value=r.map(e=>({id:e.id,title:e.title,content:e.content,summary:e.summary||"",coverImage:e.coverImage,author:e.author||l("admin"),viewCount:e.viewCount||0,createdAt:e.createdAt||"",updatedAt:e.updatedAt||""})),w.value=t.total||0,x.value=t.pages||0}else y.error(l("api.getArticleListFailed"))}catch(s){console.error(l("api.getArticleListFailed"),s),y.error(l("api.getArticleListFailed"))}finally{u.value=!1}};return{loading:u,articles:v,currentPage:p,pageSize:A,total:w,totalPages:x,themeStore:_,fetchArticles:h,fetchArticleDetail:async s=>{try{const t=await G.get(`/articles/${s}`),r=t.data;return t.code===200&&r?{id:r.id,title:r.title,content:r.content,summary:r.summary||"",coverImage:r.coverImage,author:r.author||l("admin"),viewCount:r.viewCount||0,createdAt:r.createdAt||"",updatedAt:r.updatedAt||""}:(y.error(l("api.getArticleListFailed")),null)}catch(t){return console.error(l("api.getArticleDetailFailed"),t),y.error(l("api.getArticleDetailFailed")),null}},viewArticle:s=>{P.push(`/user/articles-detail/${s}`)},handlePageChange:s=>{p.value=s,h()},formatDate:s=>new Date(s).toLocaleDateString("zh-CN"),getArticleSummary:s=>{const t=s.replace(/<[^>]*>/g,"");return t.length>100?t.substring(0,100)+"...":t},handleImageError:s=>{const t=s.target;t.src="/pet.png"},initialize:()=>{h()}}},Z={class:"carousel-container"},ee={class:"articles-grid"},te=["onClick"],ae={class:"article-cover"},se=["src","alt"],oe={class:"view-count"},re={class:"article-content"},ie={class:"article-title"},ne={class:"article-summary"},le={class:"article-meta"},ce={class:"article-author"},de={class:"article-date"},ue={key:0,class:"article-updated"},me={key:0,class:"empty-state"},fe=F({__name:"Articles",setup(P){const{loading:l,articles:_,currentPage:u,pageSize:v,total:p,totalPages:A,themeStore:w,viewArticle:x,handlePageChange:h,formatDate:C,getArticleSummary:k,initialize:S}=X(),z=M=>{const n=M.target;n.src="https://images.unsplash.com/photo-1583337130417-3346a1be7dee?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80"};return E(()=>{S()}),(M,n)=>{const D=B("el-carousel-item"),s=B("el-carousel"),t=B("el-icon"),r=j("loading");return d(),f("div",{class:Y(["articles-container",{dark:a(w).preferences.theme==="dark"}])},[o("div",Z,[i(s,{height:"450px","indicator-position":"outside",arrow:"always"},{default:c(()=>[i(D,null,{default:c(()=>[...n[1]||(n[1]=[o("div",{class:"carousel-image-container"},[o("img",{src:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1600&q=80",alt:"自然风景",class:"carousel-image"})],-1)])]),_:1}),i(D,null,{default:c(()=>[...n[2]||(n[2]=[o("div",{class:"carousel-image-container"},[o("img",{src:"https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1600&q=80",alt:"自然风景",class:"carousel-image"})],-1)])]),_:1}),i(D,null,{default:c(()=>[...n[3]||(n[3]=[o("div",{class:"carousel-image-container"},[o("img",{src:"https://images.unsplash.com/photo-1469474968028-56623f02e42e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1600&q=80",alt:"自然风景",class:"carousel-image"})],-1)])]),_:1})]),_:1})]),L((d(),f("div",ee,[(d(!0),f(q,null,W(a(_),e=>(d(),f("div",{key:e.id,class:"article-card",onClick:ge=>a(x)(e.id)},[o("div",ae,[o("img",{src:e.coverImage||"https://images.unsplash.com/photo-1583337130417-3346a1be7dee?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80",alt:e.title,onError:z},null,40,se),o("div",oe,[i(t,null,{default:c(()=>[i(a(T))]),_:1}),b(" "+g(e.viewCount),1)])]),o("div",re,[o("h3",ie,g(e.title),1),o("p",ne,g(e.summary||a(k)(e.content)),1),o("div",le,[o("span",ce,[i(t,null,{default:c(()=>[i(a($))]),_:1}),b(" "+g(e.author||"管理员"),1)]),o("span",de,[i(t,null,{default:c(()=>[i(a(R))]),_:1}),b(" "+g(a(C)(e.createdAt)),1)]),e.updatedAt&&e.updatedAt!==e.createdAt?(d(),f("span",ue,[i(t,null,{default:c(()=>[i(a(O))]),_:1}),b(" "+g(a(C)(e.updatedAt)),1)])):H("",!0)])])],8,te))),128))])),[[r,a(l)]]),!a(l)&&a(_).length===0?(d(),f("div",me,[i(t,null,{default:c(()=>[i(a(Q))]),_:1}),n[4]||(n[4]=o("p",null,"暂无文章",-1))])):H("",!0),a(A)>=1?(d(),N(J,{key:1,"current-page":a(u),"page-size":a(v),total:a(p),"onUpdate:currentPage":n[0]||(n[0]=e=>u.value=e),onPageChange:a(h)},null,8,["current-page","page-size","total","onPageChange"])):H("",!0)],2)}}}),we=K(fe,[["__scopeId","data-v-8ce7e9c1"]]);export{we as default};
