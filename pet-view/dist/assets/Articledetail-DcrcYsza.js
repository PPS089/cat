import{u as N,i as g,E as f,j as F,s as M,d as V,l as B,v as z,U as H,p as e,o as n,c as _,H as A,a as t,t as p,e as o,w as c,r as y,F as j,f as $,J,X as R,n as U,C as W,M as X,V as q,T as G,g as w,W as K}from"./index-vX8o4tFx.js";import{useThemeStore as O}from"./theme-BuSJrrmb.js";const P=()=>{const{t:r}=N(),h=F(),l=O(),d=g(!1),u=g(null),m=g(!1),k=g([r("article.petCare"),r("article.knowledgeSharing"),r("article.experienceSummary")]);return{loading:d,article:u,isLiked:m,articleTags:k,themeStore:l,t:r,fetchArticleDetail:async()=>{const a=Number(h.params.id);if(!a){f.error(r("api.invalidArticleId"));return}d.value=!0;try{const s=await M.get(`/articles/${a}`);if(s.code===200&&s.data){const i=s.data;u.value={id:i.id||0,title:i.title||"",content:i.content||"",summary:i.summary||"",createdAt:i.createdAt||"",viewCount:i.viewCount||0,coverImage:i.coverImage||"",author:i.author||""}}else f.error(r("api.getArticleDetailFailed"))}catch(s){console.error(r("api.getArticleDetailFailed"),s),f.error(r("api.getArticleDetailFailed"))}finally{d.value=!1}},formatDate:a=>new Date(a).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"}),formatContent:a=>a.split(`

`).map(i=>`<p>${i}</p>`).join(""),likeArticle:()=>{m.value=!m.value,f.success(m.value?r("api.likeSuccess"):r("api.unlikeSuccess"))},shareArticle:()=>{navigator.share?navigator.share({title:u.value?.title||"",text:u.value?.summary||"",url:window.location.href}):(navigator.clipboard.writeText(window.location.href),f.success(r("api.linkCopied")))},handleImageError:a=>{const s=a.target;s.style.display="none"}}},Q={key:0,class:"article-content"},Y={class:"article-header"},Z={class:"article-title"},ee={class:"article-meta"},te={class:"meta-item"},ae={class:"meta-item"},se={class:"meta-item"},le={key:0,class:"article-cover"},re=["src","alt"],ie={key:0,class:"article-summary"},oe={class:"article-body"},ne=["innerHTML"],ce={class:"article-footer"},de={class:"article-tags"},ue={class:"article-actions"},me={key:1,class:"empty-state"},fe=V({__name:"Articledetail",setup(r){const{loading:h,article:l,isLiked:d,articleTags:u,themeStore:m,fetchArticleDetail:k,formatDate:D,formatContent:I,likeArticle:S,shareArticle:x,handleImageError:C}=P();return B(()=>{k()}),(E,a)=>{const s=y("el-icon"),i=y("el-alert"),b=y("el-tag"),T=y("el-button"),L=H("loading");return z((n(),_("div",{class:U(["article-detail-container",{dark:e(m).preferences.theme==="dark"}])},[e(l)?(n(),_("div",Q,[t("header",Y,[t("h1",Z,p(e(l).title),1),t("div",ee,[t("div",te,[o(s,null,{default:c(()=>[o(e(W))]),_:1}),t("span",null,p(e(l).author||"管理员"),1)]),t("div",ae,[o(s,null,{default:c(()=>[o(e(X))]),_:1}),t("span",null,p(e(D)(e(l).createdAt)),1)]),t("div",se,[o(s,null,{default:c(()=>[o(e(q))]),_:1}),t("span",null,p(e(l).viewCount)+" 次阅读",1)])]),e(l).coverImage?(n(),_("div",le,[t("img",{src:e(l).coverImage,alt:e(l).title,onError:a[0]||(a[0]=(...v)=>e(C)&&e(C)(...v))},null,40,re)])):A("",!0)]),e(l).summary?(n(),_("div",ie,[o(i,{title:e(l).summary,type:"info",closable:!1},null,8,["title"])])):A("",!0),t("main",oe,[t("div",{class:"article-text",innerHTML:e(I)(e(l).content)},null,8,ne)]),t("footer",ce,[t("div",de,[(n(!0),_(j,null,$(e(u),v=>(n(),G(b,{key:v,size:"small",type:"info"},{default:c(()=>[w(p(v),1)]),_:2},1024))),128))]),t("div",ue,[o(T,{onClick:e(S),icon:e(J),type:e(d)?"warning":"default"},{default:c(()=>[w(p(e(d)?"已收藏":"收藏"),1)]),_:1},8,["onClick","icon","type"]),o(T,{onClick:e(x),icon:e(R),type:"primary"},{default:c(()=>[...a[1]||(a[1]=[w(" 分享 ",-1)])]),_:1},8,["onClick","icon"])])])])):e(h)?A("",!0):(n(),_("div",me,[o(s,null,{default:c(()=>[o(e(K))]),_:1}),a[2]||(a[2]=t("p",null,"文章不存在或已删除",-1))]))],2)),[[L,e(h)]])}}});export{fe as default};
