import{_ as k}from"./dog-CLIpk0wi.js";import{u as b,i as u,m as B,s as j,E as P,d as T,l as M,c as p,o as g,a as o,v as $,H as N,T as U,e as l,w as c,r as z,U as H,p as a,F as R,f as W,n as q,g as D,V as G,t as v,C as J,M as K,W as O,_ as Q}from"./index-vX8o4tFx.js";import{useThemeStore as X}from"./theme-BuSJrrmb.js";import{P as Y}from"./Pagination-D5dvJ28X.js";const Z=()=>{const I=B(),{t:i}=b(),h=X(),d=u(!1),f=u([]),m=u(1),y=u(12),A=u(0),w=u(0),_=async()=>{d.value=!0;try{const e=await j.get("/articles",{params:{currentPage:m.value,pageSize:y.value}});if(e.code===200){const n=e.data.records||[];f.value=n.map(t=>({id:t.id,title:t.title,content:t.content,summary:t.summary||"",coverImage:t.coverImage,author:t.author||i("admin"),viewCount:t.viewCount||0,createdAt:t.createdAt||""})),A.value=e.data.total||0,w.value=e.data.pages||0}else P.error(i("api.getArticleListFailed"))}catch(e){console.error(i("api.getArticleListFailed"),e),P.error(i("api.getArticleListFailed"))}finally{d.value=!1}};return{loading:d,articles:f,currentPage:m,pageSize:y,total:A,totalPages:w,themeStore:h,fetchArticles:_,fetchArticleDetail:async e=>{try{const s=await j.get(`/articles/${e}`),n=s.data;return s.code===200&&n?{id:n.id,title:n.title,content:n.content,summary:n.summary||"",coverImage:n.coverImage,author:n.author||i("admin"),viewCount:n.viewCount||0,createdAt:n.createdAt||""}:(P.error(i("api.getArticleListFailed")),null)}catch(s){return console.error(i("api.getArticleDetailFailed"),s),P.error(i("api.getArticleDetailFailed")),null}},viewArticle:e=>{I.push(`/user/articles-detail/${e}`)},handlePageChange:e=>{m.value=e,_()},formatDate:e=>new Date(e).toLocaleDateString("zh-CN"),getArticleSummary:e=>{const s=e.replace(/<[^>]*>/g,"");return s.length>100?s.substring(0,100)+"...":s},handleImageError:e=>{const s=e.target;s.src="/images/default-article.jpg"},initialize:()=>{_()}}},ee={class:"carousel-container"},te={class:"articles-grid"},ae=["onClick"],se={class:"article-cover"},re=["alt"],oe={class:"view-count"},ne={class:"article-content"},le={class:"article-title"},ie={class:"article-summary"},ce={class:"article-meta"},de={class:"article-author"},ue={class:"article-date"},ge={key:0,class:"empty-state"},me=T({__name:"Articles",setup(I){const{loading:i,articles:h,currentPage:d,pageSize:f,total:m,totalPages:y,themeStore:A,viewArticle:w,handlePageChange:_,formatDate:F,getArticleSummary:x,handleImageError:S,initialize:E}=Z();return M(()=>{E()}),(V,r)=>{const C=z("el-carousel-item"),e=z("el-carousel"),s=z("el-icon"),n=H("loading");return g(),p("div",{class:q(["articles-container",{dark:a(A).preferences.theme==="dark"}])},[o("div",ee,[l(e,{height:"400px","indicator-position":"outside",arrow:"always"},{default:c(()=>[l(C,null,{default:c(()=>[...r[2]||(r[2]=[o("img",{src:k,alt:"可爱的宠物",style:{width:"100%",height:"100%","object-fit":"cover"}},null,-1)])]),_:1}),l(C,null,{default:c(()=>[...r[3]||(r[3]=[o("img",{src:k,alt:"可爱的宠物",style:{width:"100%",height:"100%","object-fit":"cover"}},null,-1)])]),_:1}),l(C,null,{default:c(()=>[...r[4]||(r[4]=[o("img",{src:k,alt:"可爱的宠物",style:{width:"100%",height:"100%","object-fit":"cover"}},null,-1)])]),_:1})]),_:1})]),$((g(),p("div",te,[(g(!0),p(R,null,W(a(h),t=>(g(),p("div",{key:t.id,class:"article-card",onClick:L=>a(w)(t.id)},[r[5]||(r[5]=D(" > ",-1)),o("div",se,[o("img",{src:"/src/assets/img/dog.jpg",alt:t.title,onError:r[0]||(r[0]=(...L)=>a(S)&&a(S)(...L))},null,40,re),o("div",oe,[l(s,null,{default:c(()=>[l(a(G))]),_:1}),D(" "+v(t.viewCount),1)])]),o("div",ne,[o("h3",le,v(t.title),1),o("p",ie,v(t.summary||a(x)(t.content)),1),o("div",ce,[o("span",de,[l(s,null,{default:c(()=>[l(a(J))]),_:1}),D(" "+v(t.author||"管理员"),1)]),o("span",ue,[l(s,null,{default:c(()=>[l(a(K))]),_:1}),D(" "+v(a(F)(t.createdAt)),1)])])])],8,ae))),128))])),[[n,a(i)]]),!a(i)&&a(h).length===0?(g(),p("div",ge,[l(s,null,{default:c(()=>[l(a(O))]),_:1}),r[6]||(r[6]=o("p",null,"暂无文章",-1))])):N("",!0),a(y)>1?(g(),U(Y,{key:1,"current-page":a(d),"page-size":a(f),total:a(m),"onUpdate:currentPage":r[1]||(r[1]=t=>d.value=t),onPageChange:a(_)},null,8,["current-page","page-size","total","onPageChange"])):N("",!0)],2)}}}),fe=Q(me,[["__scopeId","data-v-1d78dc14"]]);export{fe as default};
