import{_ as k}from"./dog-CLIpk0wi.js";import{u as B,h as u,l as T,E as D,d as V,k as $,c as p,o as g,a as o,q as M,D as L,R,e as l,w as c,r as z,S as U,m as a,F as q,f as K,n as G,g as P,T as H,t as h,A as J,K as O,U as Q,_ as W}from"./index-CzjmnDZ-.js";import{useThemeStore as X}from"./theme-BvsCIQ48.js";import{s as j}from"./request-Dybetxu6.js";import{P as Y}from"./Pagination-DDL7dCiL.js";const Z=()=>{const I=T(),{t:i}=B(),v=X(),d=u(!1),f=u([]),m=u(1),A=u(12),y=u(0),w=u(0),_=async()=>{d.value=!0;try{const e=await j.get("/articles",{params:{currentPage:m.value,pageSize:A.value}});if(e.code===200){const n=e.data.records||[];f.value=n.map(t=>({id:t.id,title:t.title,content:t.content,summary:t.summary||"",coverImage:t.coverImage,author:t.author||i("admin"),viewCount:t.viewCount||0,createdAt:t.createdAt||""})),y.value=e.data.total||0,w.value=e.data.pages||0}else D.error(i("api.getArticleListFailed"))}catch(e){console.error(i("api.getArticleListFailed"),e),D.error(i("api.getArticleListFailed"))}finally{d.value=!1}};return{loading:d,articles:f,currentPage:m,pageSize:A,total:y,totalPages:w,themeStore:v,fetchArticles:_,fetchArticleDetail:async e=>{try{const s=await j.get(`/articles/${e}`),n=s.data;return s.code===200&&n?{id:n.id,title:n.title,content:n.content,summary:n.summary||"",coverImage:n.coverImage,author:n.author||i("admin"),viewCount:n.viewCount||0,createdAt:n.createdAt||""}:(D.error(i("api.getArticleListFailed")),null)}catch(s){return console.error(i("api.getArticleDetailFailed"),s),D.error(i("api.getArticleDetailFailed")),null}},viewArticle:e=>{I.push(`/user/articles-detail/${e}`)},handlePageChange:e=>{m.value=e,_()},formatDate:e=>new Date(e).toLocaleDateString("zh-CN"),getArticleSummary:e=>{const s=e.replace(/<[^>]*>/g,"");return s.length>100?s.substring(0,100)+"...":s},handleImageError:e=>{const s=e.target;s.src="/images/default-article.jpg"},initialize:()=>{_()}}},ee={class:"carousel-container"},te={class:"articles-grid"},ae=["onClick"],se={class:"article-cover"},re=["alt"],oe={class:"view-count"},ne={class:"article-content"},le={class:"article-title"},ie={class:"article-summary"},ce={class:"article-meta"},de={class:"article-author"},ue={class:"article-date"},ge={key:0,class:"empty-state"},me=V({__name:"Articles",setup(I){const{loading:i,articles:v,currentPage:d,pageSize:f,total:m,totalPages:A,themeStore:y,viewArticle:w,handlePageChange:_,formatDate:F,getArticleSummary:x,handleImageError:S,initialize:E}=Z();return $(()=>{E()}),(N,r)=>{const C=z("el-carousel-item"),e=z("el-carousel"),s=z("el-icon"),n=U("loading");return g(),p("div",{class:G(["articles-container",{dark:a(y).preferences.theme==="dark"}])},[o("div",ee,[l(e,{height:"400px","indicator-position":"outside",arrow:"always"},{default:c(()=>[l(C,null,{default:c(()=>[...r[2]||(r[2]=[o("img",{src:k,alt:"可爱的宠物",style:{width:"100%",height:"100%","object-fit":"cover"}},null,-1)])]),_:1}),l(C,null,{default:c(()=>[...r[3]||(r[3]=[o("img",{src:k,alt:"可爱的宠物",style:{width:"100%",height:"100%","object-fit":"cover"}},null,-1)])]),_:1}),l(C,null,{default:c(()=>[...r[4]||(r[4]=[o("img",{src:k,alt:"可爱的宠物",style:{width:"100%",height:"100%","object-fit":"cover"}},null,-1)])]),_:1})]),_:1})]),M((g(),p("div",te,[(g(!0),p(q,null,K(a(v),t=>(g(),p("div",{key:t.id,class:"article-card",onClick:b=>a(w)(t.id)},[r[5]||(r[5]=P(" > ",-1)),o("div",se,[o("img",{src:"/src/assets/img/dog.jpg",alt:t.title,onError:r[0]||(r[0]=(...b)=>a(S)&&a(S)(...b))},null,40,re),o("div",oe,[l(s,null,{default:c(()=>[l(a(H))]),_:1}),P(" "+h(t.viewCount),1)])]),o("div",ne,[o("h3",le,h(t.title),1),o("p",ie,h(t.summary||a(x)(t.content)),1),o("div",ce,[o("span",de,[l(s,null,{default:c(()=>[l(a(J))]),_:1}),P(" "+h(t.author||"管理员"),1)]),o("span",ue,[l(s,null,{default:c(()=>[l(a(O))]),_:1}),P(" "+h(a(F)(t.createdAt)),1)])])])],8,ae))),128))])),[[n,a(i)]]),!a(i)&&a(v).length===0?(g(),p("div",ge,[l(s,null,{default:c(()=>[l(a(Q))]),_:1}),r[6]||(r[6]=o("p",null,"暂无文章",-1))])):L("",!0),a(A)>1?(g(),R(Y,{key:1,"current-page":a(d),"page-size":a(f),total:a(m),"onUpdate:currentPage":r[1]||(r[1]=t=>d.value=t),onPageChange:a(_)},null,8,["current-page","page-size","total","onPageChange"])):L("",!0)],2)}}}),Ae=W(me,[["__scopeId","data-v-3db2b206"]]);export{Ae as default};
