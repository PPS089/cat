import{u as I,h as m,l as V,E as y,d as F,k as E,c as f,o as d,a as o,N as j,z as H,O as L,e as i,w as c,r as B,P as N,m as a,F as q,f as W,n as Y,g as b,Q as T,t as g,p as $,G as R,R as O,S as Q,_ as U}from"./index-C-QPrTeL.js";import{useThemeStore as J}from"./theme-DZbca66G.js";import{s as G}from"./request-C9ntlt9z.js";import{P as K}from"./Pagination-B0Zm-mWW.js";const X=()=>{const P=V(),{t:n}=I(),_=J(),u=m(!1),v=m([]),p=m(1),A=m(12),w=m(0),x=m(0),h=async()=>{u.value=!0;try{const t=await G.get("/articles",{params:{currentPage:p.value,pageSize:A.value}});if(t.code===200){const r=t.data.records||[];v.value=r.map(e=>({id:e.id,title:e.title,content:e.content,summary:e.summary||"",coverImage:e.coverImage,author:e.author||n("admin"),viewCount:e.viewCount||0,createdAt:e.createdAt||"",updatedAt:e.updatedAt||""})),w.value=t.data.total||0,x.value=t.data.pages||0}else y.error(n("api.getArticleListFailed"))}catch(t){console.error(n("api.getArticleListFailed"),t),y.error(n("api.getArticleListFailed"))}finally{u.value=!1}};return{loading:u,articles:v,currentPage:p,pageSize:A,total:w,totalPages:x,themeStore:_,fetchArticles:h,fetchArticleDetail:async t=>{try{const s=await G.get(`/articles/${t}`),r=s.data;return s.code===200&&r?{id:r.id,title:r.title,content:r.content,summary:r.summary||"",coverImage:r.coverImage,author:r.author||n("admin"),viewCount:r.viewCount||0,createdAt:r.createdAt||"",updatedAt:r.updatedAt||""}:(y.error(n("api.getArticleListFailed")),null)}catch(s){return console.error(n("api.getArticleDetailFailed"),s),y.error(n("api.getArticleDetailFailed")),null}},viewArticle:t=>{P.push(`/user/articles-detail/${t}`)},handlePageChange:t=>{p.value=t,h()},formatDate:t=>new Date(t).toLocaleDateString("zh-CN"),getArticleSummary:t=>{const s=t.replace(/<[^>]*>/g,"");return s.length>100?s.substring(0,100)+"...":s},handleImageError:t=>{const s=t.target;s.src="/images/default-article.jpg"},initialize:()=>{h()}}},Z={class:"carousel-container"},ee={class:"articles-grid"},te=["onClick"],ae={class:"article-cover"},se=["src","alt"],oe={class:"view-count"},re={class:"article-content"},ie={class:"article-title"},le={class:"article-summary"},ne={class:"article-meta"},ce={class:"article-author"},de={class:"article-date"},ue={key:0,class:"article-updated"},me={key:0,class:"empty-state"},fe=F({__name:"Articles",setup(P){const{loading:n,articles:_,currentPage:u,pageSize:v,total:p,totalPages:A,themeStore:w,viewArticle:x,handlePageChange:h,formatDate:C,getArticleSummary:k,initialize:S}=X(),z=M=>{const l=M.target;l.src="https://images.unsplash.com/photo-1583337130417-3346a1be7dee?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80"};return E(()=>{S()}),(M,l)=>{const D=B("el-carousel-item"),t=B("el-carousel"),s=B("el-icon"),r=N("loading");return d(),f("div",{class:Y(["articles-container",{dark:a(w).preferences.theme==="dark"}])},[o("div",Z,[i(t,{height:"450px","indicator-position":"outside",arrow:"always"},{default:c(()=>[i(D,null,{default:c(()=>[...l[1]||(l[1]=[o("div",{class:"carousel-image-container"},[o("img",{src:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1600&q=80",alt:"自然风景",class:"carousel-image"})],-1)])]),_:1}),i(D,null,{default:c(()=>[...l[2]||(l[2]=[o("div",{class:"carousel-image-container"},[o("img",{src:"https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1600&q=80",alt:"自然风景",class:"carousel-image"})],-1)])]),_:1}),i(D,null,{default:c(()=>[...l[3]||(l[3]=[o("div",{class:"carousel-image-container"},[o("img",{src:"https://images.unsplash.com/photo-1469474968028-56623f02e42e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1600&q=80",alt:"自然风景",class:"carousel-image"})],-1)])]),_:1})]),_:1})]),j((d(),f("div",ee,[(d(!0),f(q,null,W(a(_),e=>(d(),f("div",{key:e.id,class:"article-card",onClick:ge=>a(x)(e.id)},[o("div",ae,[o("img",{src:e.coverImage||"https://images.unsplash.com/photo-1583337130417-3346a1be7dee?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80",alt:e.title,onError:z},null,40,se),o("div",oe,[i(s,null,{default:c(()=>[i(a(T))]),_:1}),b(" "+g(e.viewCount),1)])]),o("div",re,[o("h3",ie,g(e.title),1),o("p",le,g(e.summary||a(k)(e.content)),1),o("div",ne,[o("span",ce,[i(s,null,{default:c(()=>[i(a($))]),_:1}),b(" "+g(e.author||"管理员"),1)]),o("span",de,[i(s,null,{default:c(()=>[i(a(R))]),_:1}),b(" "+g(a(C)(e.createdAt)),1)]),e.updatedAt&&e.updatedAt!==e.createdAt?(d(),f("span",ue,[i(s,null,{default:c(()=>[i(a(O))]),_:1}),b(" "+g(a(C)(e.updatedAt)),1)])):H("",!0)])])],8,te))),128))])),[[r,a(n)]]),!a(n)&&a(_).length===0?(d(),f("div",me,[i(s,null,{default:c(()=>[i(a(Q))]),_:1}),l[4]||(l[4]=o("p",null,"暂无文章",-1))])):H("",!0),a(A)>1?(d(),L(K,{key:1,"current-page":a(u),"page-size":a(v),total:a(p),"onUpdate:currentPage":l[0]||(l[0]=e=>u.value=e),onPageChange:a(h)},null,8,["current-page","page-size","total","onPageChange"])):H("",!0)],2)}}}),Ae=U(fe,[["__scopeId","data-v-ae8e30a4"]]);export{Ae as default};
