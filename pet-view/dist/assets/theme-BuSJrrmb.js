import{ag as E,i as C,ah as S}from"./index-vX8o4tFx.js";const P=E("theme",()=>{const i={language:"zh-CN",theme:"light",primaryColor:"#409EFF",fontSize:14,animations:!0,compactMode:!1},e=C({...i}),m=()=>{try{localStorage.setItem("language",e.value.language),localStorage.setItem("theme",e.value.theme),localStorage.setItem("primaryColor",e.value.primaryColor),localStorage.setItem("preferences",JSON.stringify({fontSize:e.value.fontSize,animations:e.value.animations,compactMode:e.value.compactMode}))}catch(t){console.error("保存设置到localStorage失败:",t)}},c=()=>{try{document.documentElement.style.setProperty("--el-color-primary",e.value.primaryColor);const t=e.value.theme,o=document.documentElement.classList.contains("dark"),r=document.documentElement.classList.contains("light");t==="dark"?(o||document.documentElement.classList.add("dark"),r&&document.documentElement.classList.remove("light")):t==="light"?(r||document.documentElement.classList.add("light"),o&&document.documentElement.classList.remove("dark")):window.matchMedia("(prefers-color-scheme: dark)").matches?(o||document.documentElement.classList.add("dark"),r&&document.documentElement.classList.remove("light")):(r||document.documentElement.classList.add("light"),o&&document.documentElement.classList.remove("dark"));const l=document.documentElement.style.fontSize,a=e.value.fontSize+"px";l!==a&&(document.documentElement.style.setProperty("--base-font-size",a),document.documentElement.style.fontSize=a);const s=e.value.animations,d=document.documentElement.classList.contains("no-animations");!s&&!d?(document.documentElement.style.setProperty("--el-transition-duration","0s"),document.documentElement.classList.add("no-animations")):s&&d&&(document.documentElement.style.removeProperty("--el-transition-duration"),document.documentElement.classList.remove("no-animations"));const u=e.value.compactMode,p=document.documentElement.classList.contains("compact-mode");u&&!p?document.documentElement.classList.add("compact-mode"):!u&&p&&document.documentElement.classList.remove("compact-mode"),setTimeout(()=>{y()},0)}catch(t){console.error("应用主题失败:",t)}},y=()=>{setTimeout(()=>{const t=document.querySelector(".top-header");t&&(t.style.background=`linear-gradient(135deg, ${e.value.primaryColor} 0%, ${n(e.value.primaryColor,-20)} 100%)`);const o=document.querySelector(".sidebar");o&&(e.value.theme==="dark"?o.style.background="linear-gradient(180deg, #1f1f1f 0%, #141414 100%)":o.style.background="linear-gradient(180deg, #ffffff 0%, #f8f9fa 100%)"),document.querySelectorAll(".nav-link.active").forEach(s=>{s.style.background=`linear-gradient(135deg, ${e.value.primaryColor} 0%, ${n(e.value.primaryColor,-20)} 100%)`});const l=document.querySelector(".user-dropdown-header");l&&(l.style.background=`linear-gradient(135deg, ${e.value.primaryColor} 0%, ${n(e.value.primaryColor,-20)} 100%)`),document.querySelectorAll(".el-button--primary").forEach(s=>{s.style.backgroundColor=e.value.primaryColor,s.style.borderColor=e.value.primaryColor}),document.documentElement.style.setProperty("--el-color-primary",e.value.primaryColor),document.documentElement.style.setProperty("--el-color-primary-light-3",n(e.value.primaryColor,30)),document.documentElement.style.setProperty("--el-color-primary-light-5",n(e.value.primaryColor,50)),document.documentElement.style.setProperty("--el-color-primary-light-7",n(e.value.primaryColor,70)),document.documentElement.style.setProperty("--el-color-primary-light-8",n(e.value.primaryColor,80)),document.documentElement.style.setProperty("--el-color-primary-light-9",n(e.value.primaryColor,90)),document.documentElement.style.setProperty("--el-color-primary-dark-2",n(e.value.primaryColor,-20))},100)},n=(t,o)=>{if(t.startsWith("#")){const r=parseInt(t.replace("#",""),16),l=Math.max(0,Math.min(255,(r>>16)+o)),a=Math.max(0,Math.min(255,(r>>8&255)+o)),s=Math.max(0,Math.min(255,(r&255)+o));return`#${(l<<16|a<<8|s).toString(16).padStart(6,"0")}`}return t},f=()=>{try{const t=localStorage.getItem("language");console.log("从localStorage加载语言:",t),t?e.value.language=t:console.log("未找到保存的语言，使用默认:",e.value.language);const o=localStorage.getItem("theme");o&&["light","dark","auto"].includes(o)&&(e.value.theme=o);const r=localStorage.getItem("primaryColor");r&&(e.value.primaryColor=r);const l=localStorage.getItem("preferences");if(l)try{const a=JSON.parse(l);Object.assign(e.value,a)}catch(a){console.error("加载偏好设置失败:",a)}}catch(t){console.error("加载设置失败:",t)}},g=(t,o)=>{e.value[t]=o,m(),c()},h=t=>{Object.assign(e.value,t),m(),c()},v=()=>{e.value={...i},m(),c()};return{preferences:S(e),loadPreferences:f,updatePreference:g,updatePreferences:h,applyTheme:c,resetToDefault:v}});export{P as useThemeStore};
